# 畳み込みニューラルネットワークにおける、日本式ナンバープレートの素数判定
### ・目的
Pythonを用い画像データである日本のナンバープレート下部の数字を読み込み、その数字が素数かどうかを判定する。

### ・概要
<b>ver1.0</b>は下記の流れに従い、Python言語、numpy、pandas、scikit-learn、OpenCV4、Tensorflow、Kerasのライブラリを使用しコーディングされている。

「画像からナンバープレート抽出→360 x 180のサイズに整える→ナンバープレート下部の４桁以下の数字の読み込み→素数判定」

画像抽出にはOpenCVを使用した。グレースケール、画像の平滑化のためにガウシアンフィルタ、中央値フィルタを使用し、Cannyによるエッジ検出、そして二値化を実施している。また、モルフォロジー演算を施し、Dilationによる膨張処理を行っている。そこからナンバープレート下部の４桁以下の数値の場所に当たりをつけ、数値を読み取っている。また、学習モデルは畳み込みニューラルネットワークで、カーネルは3 x 3行列で実施し、活性化関数はReLUを使用した。そして、ニューラル層はインプット層を含め３層構造である。最適化には確率降下法を用い、目的関数はカテゴリカルクロスエントロピ、評価指標はAccuracyとなっている。素数判定は、数値が約数を1と自分自身以外の約数を持つか否かで判定している。

### ・目次
  1. 画像処理
  1. 数字抽出
  1. 学習モデル
  1. 素数判定と結果

### 1. 画像処理
ここのセクションの最終目標はOpenCVライブラリー使用し、ナンバープレートの４桁以下の数字がどこに位置しており、その一つ一つの数字を抽出することである。そのために、先ず画像の前処理としてcv2.cvtColor()を使いグレースケール変換、画像のホワイトノイズ除去のためcv2.GaussianBlur()、およびスパイクノイズ除去のためcv2.medianBlur()を実施。次に、輝度差の大きい部分のエッジ検出のためcv2.Cannyを使用している。これによりナンバープレートに記載内容のエッジが取れるようになる。そして、最後に画像をぼかすためにモルフォロジー変換（収縮・膨張処理）を実施。以上より、ナンバープレート下部の４桁以下の数字の場所の位置を把握できるようになる。

### 2. 数字抽出
前節でナンバープレートの記載部分をブロック分割することができたため、ここからブロック分割された領域の外接矩形に関して考える。そのためにcv2.boundingRect()を使用し外接矩形の左端の頂点座標と縦横の長さを抽出する。そうすることで外接矩形の領域情報を得ることができる。その得た領域情報を基に、面積や縦横の比率からナンバープレートの４桁以下の数字の場所を絞り込む。数字を抽出後、この後の学習モデル構築のため正方形に整形を行った。

### 3. 学習モデル
学習モデルは3×3カーネル行列で畳み込み、MaxPoolongを行い、ReLU関数で活性化。その後、アフィン→ReLU→アフィン→Softmaxを繰り返しニューラル層を構築している。今回の学習データ量を考慮し、ニューラル層を多くすると過学習を起こすことを懸念し、インプット層を含めた３層構造を取った。また、先述した通り、最適化には学習率０．０５の確率降下法を用い、目的関数はカテゴリカルクロスエントロピ、評価指標はAccuracyを考えた。ここで、学習を行う上で、学習データの数が少なく心許ない状態だっため、数字がはっきりしないデータを使用、データを微回転、ボカシを行い、データの水増しを行い、学習モデルの精度向上を図っている。

### 4. 素数判定と結果


### ・課題
静的に画像を読み込み素数判定を行っているため、リアルタイム処理ができていない。そのため、YOLOを用いて動的に処理をする必要がある。ナンバープレートさえ認識できたらあとは、今までと同じ処理を施せば素数判定が可能と考える。
